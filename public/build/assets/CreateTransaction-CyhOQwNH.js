import{p as g,u as _,g as n,o as a,i as p,b as t,t as u,k as b,m as c,F as h,q as C,d as l,f,G as S,e as V,H as T}from"./app-GP3DUhSv.js";import{_ as q}from"./AuthenticatedLayout-CJs7g6A-.js";import"./ApplicationLogo-DynWIQXa.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const B={class:"p-4 sm:p-6 max-w-xl mx-auto"},D={key:0,class:"bg-green-100 text-green-800 px-4 py-2 rounded mb-4 text-center"},N={key:1,class:"bg-red-100 text-red-800 px-4 py-2 rounded mb-4 text-center"},$={key:0,class:"bg-white border border-gray-300 rounded mt-2 max-h-48 overflow-y-auto"},U=["onClick"],E={key:1,class:"text-red-500 text-sm mt-1"},F={key:0,class:"bg-gray-100 p-3 rounded text-sm"},M={class:"pt-2"},A=["disabled"],G={key:0},I={key:1},z=Object.assign({layout:q},{__name:"CreateTransaction",setup(O){const d=g(""),i=g([]),m=g(null),y=new Date().toISOString().split("T")[0],r=_({customer_id:"",type:"credit",amount:"",description:"",date:y});function v(){if(d.value.length<3){i.value=[];return}T.get(route("customers.search"),{params:{query:d.value}}).then(s=>{i.value=s.data}).catch(s=>{console.error(s),i.value=[]})}function x(s){m.value=s,r.customer_id=s.id,d.value=s.first_name,i.value=[]}function k(){if(!r.customer_id){alert("Please select a customer before submitting.");return}r.amount=parseFloat(r.amount),r.post(route("transactions.store"),{preserveScroll:!0,onSuccess:()=>{r.reset(),r.date=y,m.value=null,d.value=""},onError:s=>{console.error("Error:",s)}})}function w(){window.history.back()}return(s,e)=>(a(),n("div",B,[s.$page.props.flash?.success?(a(),n("div",D,u(s.$page.props.flash.success),1)):p("",!0),s.$page.props.flash?.error?(a(),n("div",N,u(s.$page.props.flash.error),1)):p("",!0),t("div",{class:"flex flex-col gap-2 sm:gap-4 mb-6"},[t("button",{onClick:w,class:"text-sm bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded w-fit"}," ← Back "),e[5]||(e[5]=t("h2",{class:"text-xl sm:text-2xl font-bold text-gray-800 text-center"}," ➕ Add Transaction ",-1))]),t("form",{onSubmit:V(k,["prevent"]),class:"space-y-4 bg-white shadow-md rounded-lg p-4 sm:p-6"},[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Search Customer",-1)),b(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>d.value=o),onInput:v,class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter name or email"},null,544),[[c,d.value]]),i.value.length?(a(),n("ul",$,[(a(!0),n(h,null,C(i.value,o=>(a(),n("li",{key:o.id,onClick:j=>x(o),class:"p-2 hover:bg-blue-100 cursor-pointer"},u(o.full_name)+" ("+u(o.reg_no)+") ",9,U))),128))])):p("",!0),l(r).errors.customer_id?(a(),n("div",E,u(l(r).errors.customer_id),1)):p("",!0)]),m.value?(a(),n("div",F,[t("div",null,[e[7]||(e[7]=t("strong",null,"Name:",-1)),f(" "+u(m.value.full_name),1)]),t("div",null,[e[8]||(e[8]=t("strong",null,"Balance:",-1)),f(" NGN "+u(m.value.wallet_balance/100),1)])])):p("",!0),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Type",-1)),b(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>l(r).type=o),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},e[9]||(e[9]=[t("option",{value:"credit"},"Credit",-1),t("option",{value:"debit"},"Debit",-1)]),512),[[S,l(r).type]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Amount",-1)),b(t("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=o=>l(r).amount=o),class:"w-full border border-gray-300 rounded-md px-3 py-2",step:"0.01",min:"0",required:""},null,512),[[c,l(r).amount]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Description",-1)),b(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=o=>l(r).description=o),class:"w-full border border-gray-300 rounded-md px-3 py-2",required:""},null,512),[[c,l(r).description]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date",-1)),b(t("input",{type:"date","onUpdate:modelValue":e[4]||(e[4]=o=>l(r).date=o),class:"w-full border border-gray-300 rounded-md px-3 py-2",required:""},null,512),[[c,l(r).date]])]),t("div",M,[t("button",{type:"submit",disabled:l(r).processing||!l(r).customer_id,class:"w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 disabled:bg-gray-400"},[l(r).processing?(a(),n("span",G,"Submitting...")):(a(),n("span",I,"Submit Transaction"))],8,A)])],32)]))}});export{z as default};
